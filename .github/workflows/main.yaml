name: Build

jobs:
  build:
    strategy:
      fail-fast: false
      matrix:
        py: ["python37", "python38", "python39"]

    runs-on: ubuntu-20.04  
    steps:
    - uses: actions/checkout@v2.3.4
    - uses: cachix/install-nix-action@v13
        # https://github.com/NixOS/nixpkgs/commit/54c1e44240d8a527a8f4892608c4bce5440c3ecb
        nix_path: nixpkgs=https://github.com/NixOS/nixpkgs/archive/54c1e44240d8a527a8f4892608c4bce5440c3ecb.tar.gz
    - name: Build
      run: nix-build -E "with import <nixpkgs> {}; $PYTHON.pkgs.callPackage ./. {}"
      env:
        PYTHON: ${{ matrix.py }}  
